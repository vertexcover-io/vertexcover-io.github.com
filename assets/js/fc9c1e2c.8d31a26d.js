"use strict";(self.webpackChunkblog_vertexcover=self.webpackChunkblog_vertexcover||[]).push([[105],{614:(e,t,s)=>{s.d(t,{A:()=>i});s(6540);var r=s(4848);function i({children:e}){return(0,r.jsxs)("div",{style:{backgroundColor:"#f8f9fa",border:"1px solid #dee2e6",borderRadius:"8px",padding:"16px",margin:"20px 0",borderLeft:"4px solid #007bff"},children:[(0,r.jsx)("strong",{style:{color:"#007bff",fontSize:"14px",textTransform:"uppercase",letterSpacing:"0.5px"},children:"TL;DR:"}),(0,r.jsx)("div",{style:{marginTop:"8px"},children:e})]})}},1927:(e,t,s)=>{s(6540),s(4848)},5220:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>n,metadata:()=>r,toc:()=>x});var r=s(8151),i=s(4848),l=s(8453),a=s(614);s(6358),s(7010),s(1927),s(7742);const n={slug:"ml-infra-for-the-gpu-poor",title:"ML Infra design for the GPU Poor",description:"ML Infra design for the GPU Poor",date:new Date("2025-07-31T00:00:00.000Z"),tags:["infra"],draft:!1},o=void 0,d={authorsImageUrls:[]},x=[{value:"Taming the Beast: How to Design a Queueing System for GPU-Intensive Workloads",id:"taming-the-beast-how-to-design-a-queueing-system-for-gpu-intensive-workloads",level:2}];function c(e){const t={h2:"h2",p:"p",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h2,{id:"taming-the-beast-how-to-design-a-queueing-system-for-gpu-intensive-workloads",children:"Taming the Beast: How to Design a Queueing System for GPU-Intensive Workloads"}),"\n",(0,i.jsx)(a.A,{children:(0,i.jsx)(t.p,{children:"When designing for scale, the limiting factor is the GPU availability. So all rate limits / queueing must be designed around GPU availability."})})]})}function m(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},6358:(e,t,s)=>{s(6540),s(4848)},7010:(e,t,s)=>{s.d(t,{A:()=>l});var r=s(6540),i=s(4848);const l=()=>{const[e,t]=(0,r.useState)(!1),[s,l]=(0,r.useState)(null),a=280,n=40,o=60,d=520-o-20,x=a-n-40;(0,r.useEffect)(()=>{const e=setTimeout(()=>t(!0),300);return()=>clearTimeout(e)},[]);const c=e=>o+e*d,m=e=>{const t=Math.max(1,Math.min(e,20));return n+x-(t-1)/19*x};return(0,i.jsxs)("div",{className:"w-full bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50 p-4 md:p-8",children:[(0,i.jsx)("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:(0,i.jsxs)("div",{className:"absolute -inset-10 opacity-10",children:[(0,i.jsx)("div",{className:"absolute top-1/4 left-1/4 w-64 h-64 bg-purple-300 rounded-full mix-blend-multiply filter blur-3xl animate-pulse"}),(0,i.jsx)("div",{className:"absolute top-3/4 right-1/4 w-64 h-64 bg-blue-300 rounded-full mix-blend-multiply filter blur-3xl animate-pulse delay-1000"}),(0,i.jsx)("div",{className:"absolute bottom-1/4 left-1/2 w-64 h-64 bg-indigo-300 rounded-full mix-blend-multiply filter blur-3xl animate-pulse delay-500"})]})}),(0,i.jsxs)("div",{className:"relative max-w-6xl mx-auto",children:[(0,i.jsxs)("div",{className:"backdrop-blur-xl bg-white bg-opacity-40 rounded-3xl border border-white border-opacity-30 shadow-2xl p-4 md:p-8 mb-6 md:mb-8 relative overflow-hidden",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-tr from-white opacity-30 via-transparent to-transparent opacity-50 rounded-3xl"}),(0,i.jsx)("h1",{className:"text-2xl md:text-4xl font-bold text-gray-800 mb-6 md:mb-8 text-center relative z-10",children:"Queue Wait Time vs. System Utilization"}),(0,i.jsx)("div",{className:"relative z-10 flex justify-center overflow-x-auto",children:(0,i.jsxs)("svg",{width:520,height:a,viewBox:"0 0 520 280",className:"min-w-[520px] md:min-w-0 w-full max-w-2xl",children:[(0,i.jsxs)("defs",{children:[(0,i.jsxs)("linearGradient",{id:"curveGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,i.jsx)("stop",{offset:"0%",stopColor:"#10b981"}),(0,i.jsx)("stop",{offset:"70%",stopColor:"#f59e0b"}),(0,i.jsx)("stop",{offset:"95%",stopColor:"#ef4444"})]}),(0,i.jsxs)("filter",{id:"glow",children:[(0,i.jsx)("feGaussianBlur",{stdDeviation:"2.5",result:"coloredBlur"}),(0,i.jsxs)("feMerge",{children:[(0,i.jsx)("feMergeNode",{in:"coloredBlur"}),(0,i.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})]}),[0,.2,.4,.6,.8,1].map(e=>(0,i.jsx)("line",{x1:c(e),y1:n,x2:c(e),y2:n+x,stroke:"rgba(156, 163, 175, 0.2)",strokeWidth:"1"},`v-${e}`)),[1,5,10,15,20].map(e=>(0,i.jsx)("line",{x1:o,y1:m(e),x2:o+d,y2:m(e),stroke:"rgba(156, 163, 175, 0.2)",strokeWidth:"1"},`h-${e}`)),(0,i.jsx)("path",{d:(()=>{let e="";for(let t=0;t<=100;t++){const s=t/100*.99,r=1/(1-s),i=c(s),l=m(r);e+=0===t?`M ${i} ${l}`:` L ${i} ${l}`}return e})(),fill:"none",stroke:"url(#curveGradient)",strokeWidth:"4",filter:"url(#glow)",style:{strokeDasharray:1e3,strokeDashoffset:e?0:1e3,transition:"stroke-dashoffset 2s ease-in-out"}}),[{utilization:0,waitTime:1,label:"0%",color:"#10b981"},{utilization:.2,waitTime:1.25,label:"20%",color:"#10b981"},{utilization:.5,waitTime:2,label:"50%",color:"#10b981"},{utilization:.8,waitTime:5,label:"80%",color:"#f59e0b"},{utilization:.95,waitTime:20,label:"95%",color:"#ef4444"}].map((e,t)=>{const r=(e=>{const t=1/(1-Math.min(e,.99));return{x:c(e),y:m(t)}})(e.utilization),a=s===t;return(0,i.jsxs)("g",{transform:`translate(${r.x}, ${r.y})`,children:[(0,i.jsx)("circle",{r:a?10:6,fill:e.color,stroke:"white",strokeWidth:"2",className:"cursor-pointer transition-all duration-300",onMouseEnter:()=>l(t),onMouseLeave:()=>l(null)}),(0,i.jsx)("text",{y:-18,fill:"#374151",textAnchor:"middle",className:"text-sm font-semibold pointer-events-none",children:e.label}),a&&(0,i.jsxs)("g",{className:"pointer-events-none",children:[(0,i.jsx)("rect",{x:"-40",y:"18",width:"80",height:"28",rx:"5",fill:"rgba(0,0,0,0.9)"}),(0,i.jsxs)("text",{x:"0",y:"37",fill:"white",textAnchor:"middle",className:"text-xs font-bold",children:["~",e.waitTime.toFixed(1),"x Wait"]})]})]},t)}),(0,i.jsx)("text",{x:o+d/2,y:275,fill:"#374151",textAnchor:"middle",className:"text-sm font-medium",children:"System Utilization (\u03c1)"}),(0,i.jsx)("text",{x:o-50,y:n+x/2,fill:"#374151",textAnchor:"middle",className:"text-sm font-medium",transform:`rotate(-90 ${o-50} ${n+x/2})`,children:"Avg. Wait Time"}),[1,5,10,15,20].map(e=>(0,i.jsxs)("text",{x:o-8,y:m(e)+4,fill:"#6b7280",textAnchor:"end",className:"text-xs",children:[e,"x"]},`label-y-${e}`)),[0,.2,.4,.6,.8,1].map(e=>(0,i.jsx)("text",{x:c(e),y:n+x+15,fill:"#6b7280",textAnchor:"middle",className:"text-xs",children:100*e+"%"},`label-x-${e}`))]})})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6",children:[(0,i.jsxs)("div",{className:"lg:col-span-2 backdrop-blur-xl bg-white bg-opacity-40 rounded-2xl border border-white border-opacity-30 shadow-xl p-4 md:p-6 relative overflow-hidden",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-white opacity-20 via-transparent to-transparent opacity-30 rounded-2xl"}),(0,i.jsxs)("div",{className:"relative z-10",children:[(0,i.jsx)("h3",{className:"text-lg md:text-xl font-bold text-gray-800 mb-4",children:"Key Insight"}),(0,i.jsxs)("p",{className:"text-gray-700 mb-4 text-sm md:text-base",children:["As system load (utilization) nears its maximum capacity (100%), the time a new task has to wait in the queue increases ",(0,i.jsx)("span",{className:"text-red-600 font-bold",children:"exponentially"}),", not linearly."]}),(0,i.jsx)("div",{className:"space-y-2 md:space-y-3",children:[{level:"Safe Zone (Under 80%)",time:"Predictable & Fast",color:"bg-emerald-500"},{level:"Danger Zone (80-95%)",time:"Wait times skyrocket",color:"bg-amber-500"},{level:"Collapse (Above 95%)",time:"System becomes unstable",color:"bg-red-500"}].map((e,t)=>(0,i.jsxs)("div",{className:"flex items-center justify-between p-3 backdrop-blur-sm bg-white bg-opacity-30 rounded-lg border border-white border-opacity-20",children:[(0,i.jsxs)("div",{className:"flex items-center",children:[(0,i.jsx)("div",{className:`w-3 h-3 rounded-full ${e.color} mr-3`}),(0,i.jsx)("span",{className:"text-gray-800 text-sm md:text-base",children:e.level})]}),(0,i.jsx)("span",{className:"text-gray-600 font-medium text-sm md:text-base",children:e.time})]},t))})]})]}),(0,i.jsxs)("div",{className:"backdrop-blur-xl bg-white bg-opacity-40 rounded-2xl border border-white border-opacity-30 shadow-xl p-4 md:p-6 relative overflow-hidden",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-gradient-to-tl from-blue-500 opacity-10 via-transparent to-transparent opacity-50 rounded-2xl"}),(0,i.jsxs)("div",{className:"relative z-10",children:[(0,i.jsxs)("div",{className:"flex items-center mb-4",children:[(0,i.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-500/80 flex items-center justify-center mr-3 border-2 border-white/50",children:(0,i.jsx)("span",{className:"text-white font-bold text-xl",children:"\ud83d\udca1"})}),(0,i.jsx)("h3",{className:"text-lg md:text-xl font-bold text-gray-800",children:"Design Rule"})]}),(0,i.jsxs)("p",{className:"text-gray-700 text-sm md:text-base",children:["To maintain a stable and predictable system, design your auto-scaling and rate-limiting to keep average utilization below the ",(0,i.jsx)("b",{className:"text-blue-700",children:'~80% "knee"'})," of the curve."]})]})]})]})]})]})}},7742:(e,t,s)=>{s.d(t,{A:()=>l});var r=s(6540),i=s(4848);const l=()=>{const[e,t]=(0,r.useState)(3),[s,l]=(0,r.useState)(8),a=300,n=40,o=60,d=520-o-20,x=a-n-50,c=20,m=e=>o+e/c*d,h=e=>n+x-e/20*x,{timeToWait:u,timeToScale:b,decision:f,breakevenPoint:g}=(0,r.useMemo)(()=>{const t=e+s/2;return{timeToWait:s,timeToScale:t,decision:s>t?"SCALE NOW":"WAIT",breakevenPoint:2*e}},[s,e]),p=`M ${m(0)} ${h(0)} L ${m(c)} ${h(c)}`,j=`M ${m(0)} ${h(e)} L ${m(c)} ${h(e+10)}`;return(0,i.jsx)("div",{className:"w-full bg-gradient-to-br from-gray-50 via-indigo-50 to-blue-50 p-4 md:p-8",children:(0,i.jsx)("div",{className:"relative max-w-6xl mx-auto",children:(0,i.jsxs)("div",{className:"backdrop-blur-xl bg-white bg-opacity-40 rounded-3xl border border-white border-opacity-30 shadow-2xl p-4 md:p-8 mb-6 md:mb-8",children:[(0,i.jsx)("h1",{className:"text-2xl md:text-4xl font-bold text-gray-800 mb-2 text-center",children:"The GPU Scaling Decision"}),(0,i.jsx)("p",{className:"text-center text-gray-600 mb-8",children:"When is a cold start worth the cost?"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8 px-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"cold-start-slider",className:"block text-sm font-medium text-gray-700",children:["GPU Cold Start Time: ",(0,i.jsxs)("span",{className:"font-bold text-indigo-600",children:[e," min"]})]}),(0,i.jsx)("input",{id:"cold-start-slider",type:"range",min:"2",max:"5",step:"0.5",value:e,onChange:e=>t(Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-indigo-600"})]}),(0,i.jsxs)("div",{children:[(0,i.jsxs)("label",{htmlFor:"queue-length-slider",className:"block text-sm font-medium text-gray-700",children:["Queued Work: ",(0,i.jsxs)("span",{className:"font-bold text-teal-600",children:[s," video-minutes"]})]}),(0,i.jsx)("input",{id:"queue-length-slider",type:"range",min:"0",max:c,step:"1",value:s,onChange:e=>l(Number(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-teal-600"})]})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-8",children:[(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)("div",{className:"relative z-10 flex-shrink-0",children:(0,i.jsxs)("svg",{width:520,height:a,viewBox:"0 0 520 300",className:"min-w-[520px] md:min-w-0",children:[[0,5,10,15,20].map(e=>(0,i.jsx)("line",{x1:m(e),y1:n,x2:m(e),y2:n+x,stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"2 2"},`v-grid-${e}`)),[0,5,10,15,20].map(e=>(0,i.jsx)("line",{x1:o,y1:h(e),x2:o+d,y2:h(e),stroke:"#e5e7eb",strokeWidth:"1",strokeDasharray:"2 2"},`h-grid-${e}`)),(0,i.jsx)("line",{x1:o,y1:n+x,x2:o+d,y2:n+x,stroke:"#6b7280",strokeWidth:"2"}),(0,i.jsx)("line",{x1:o,y1:n,x2:o,y2:n+x,stroke:"#6b7280",strokeWidth:"2"}),[0,5,10,15,20].map(e=>(0,i.jsxs)("g",{children:[(0,i.jsx)("line",{x1:m(e),y1:n+x,x2:m(e),y2:n+x+5,stroke:"#6b7280",strokeWidth:"1"}),(0,i.jsx)("text",{x:m(e),y:n+x+18,textAnchor:"middle",className:"text-xs fill-gray-600 font-medium",children:e})]},`x-tick-${e}`)),[0,5,10,15,20].map(e=>(0,i.jsxs)("g",{children:[(0,i.jsx)("line",{x1:o-5,y1:h(e),x2:o,y2:h(e),stroke:"#6b7280",strokeWidth:"1"}),(0,i.jsx)("text",{x:o-10,y:h(e)+4,textAnchor:"end",className:"text-xs fill-gray-600 font-medium",children:e})]},`y-tick-${e}`)),(0,i.jsx)("line",{x1:m(g),y1:n,x2:m(g),y2:n+x,stroke:"#1e40af",strokeWidth:"2",strokeDasharray:"5 5"}),(0,i.jsx)("path",{d:p,stroke:"#f59e0b",strokeWidth:"3",fill:"none",strokeDasharray:"6 4"}),(0,i.jsx)("path",{d:j,stroke:"#14b8a6",strokeWidth:"3",fill:"none"}),(0,i.jsx)("circle",{cx:m(g),cy:h(g),r:"6",fill:"#1e40af",stroke:"white",strokeWidth:"2"}),(0,i.jsx)("text",{x:m(g),y:h(g)-12,textAnchor:"middle",className:"text-xs font-bold fill-blue-800",children:"Breakeven"}),(0,i.jsx)("text",{x:m(g),y:h(g)+20,textAnchor:"middle",className:"text-xs font-bold fill-blue-800",children:g.toFixed(1)}),(0,i.jsx)("line",{x1:m(s),y1:n,x2:m(s),y2:n+x,stroke:"#4f46e5",strokeWidth:"2",strokeDasharray:"3 3"}),(0,i.jsx)("circle",{cx:m(s),cy:h(u),r:"5",fill:"#f59e0b",stroke:"white",strokeWidth:"2"}),(0,i.jsx)("circle",{cx:m(s),cy:h(b),r:"5",fill:"#14b8a6",stroke:"white",strokeWidth:"2"}),(0,i.jsx)("text",{x:m(s),y:n-8,textAnchor:"middle",className:"text-xs font-bold fill-indigo-700",children:s}),(0,i.jsx)("text",{x:o+d/2,y:290,textAnchor:"middle",className:"text-sm font-medium fill-gray-600",children:"Video-Minutes in Queue"}),(0,i.jsx)("text",{x:o-45,y:n+x/2,textAnchor:"middle",transform:`rotate(-90 ${o-45} ${n+x/2})`,className:"text-sm font-medium fill-gray-600",children:"Time to Complete (min)"})]})})}),(0,i.jsx)("div",{className:"max-w-4xl mx-auto w-full",children:(0,i.jsxs)("div",{className:"p-6 bg-white/60 rounded-2xl border border-white/30 shadow-lg backdrop-blur-sm",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-6 text-center",children:"Calculated Outcome"}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between p-4 bg-amber-100/70 rounded-xl border border-amber-200/50",children:[(0,i.jsx)("span",{className:"font-medium text-amber-800 text-lg",children:"Time if you WAIT:"}),(0,i.jsxs)("span",{className:"font-bold text-2xl text-amber-900",children:[u.toFixed(1)," min"]})]}),(0,i.jsxs)("div",{className:"flex items-center justify-between p-4 bg-teal-100/70 rounded-xl border border-teal-200/50",children:[(0,i.jsx)("span",{className:"font-medium text-teal-800 text-lg",children:"Time if you SCALE:"}),(0,i.jsxs)("span",{className:"font-bold text-2xl text-teal-900",children:[b.toFixed(1)," min"]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-center",children:[(0,i.jsx)("div",{className:"flex justify-center lg:justify-start",children:(0,i.jsx)("div",{className:"px-8 py-4 rounded-xl text-center shadow-md min-w-[200px] "+("WAIT"===f?"bg-gradient-to-r from-amber-500 to-amber-600":"bg-gradient-to-r from-teal-500 to-teal-600"),children:(0,i.jsx)("span",{className:"text-white font-bold text-2xl tracking-wider drop-shadow-sm",children:f})})}),(0,i.jsxs)("div",{className:"text-center lg:text-left",children:[(0,i.jsx)("h4",{className:"font-semibold text-gray-700 flex items-center justify-center lg:justify-start gap-2 mb-3",children:"\ud83d\udca1 Key Insight:"}),(0,i.jsxs)("p",{className:"text-sm text-gray-600 leading-relaxed mb-3",children:["It only makes sense to provision a new GPU when the queue length is more than ",(0,i.jsx)("b",{className:"text-indigo-700",children:"twice the cold start time"}),"."]}),(0,i.jsx)("div",{className:"inline-block p-3 bg-indigo-50/70 rounded-lg border border-indigo-200/50",children:(0,i.jsxs)("p",{className:"font-bold text-lg text-indigo-800",children:["Breakeven at ",g.toFixed(1)," video-minutes"]})})]})]})]})}),(0,i.jsx)("div",{className:"flex justify-center",children:(0,i.jsx)("div",{className:"p-4 bg-white/60 rounded-xl border border-white/30 shadow-md backdrop-blur-sm",children:(0,i.jsxs)("div",{className:"flex items-center justify-center gap-8",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-4 h-4 bg-amber-500 rounded border-2 border-amber-600"}),(0,i.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Wait (Don't Scale)"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("div",{className:"w-4 h-4 bg-teal-500 rounded border-2 border-teal-600"}),(0,i.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Scale Now"})]})]})})})]})]})})})}},8151:e=>{e.exports=JSON.parse('{"permalink":"/ml-infra-for-the-gpu-poor","source":"@site/blog/2025-07-31-gpu-poor.mdx","title":"ML Infra design for the GPU Poor","description":"ML Infra design for the GPU Poor","date":"2025-07-31T00:00:00.000Z","tags":[{"inline":true,"label":"infra","permalink":"/tags/infra"}],"readingTime":4.22,"hasTruncateMarker":true,"authors":[],"frontMatter":{"slug":"ml-infra-for-the-gpu-poor","title":"ML Infra design for the GPU Poor","description":"ML Infra design for the GPU Poor","date":"2025-07-31T00:00:00.000Z","tags":["infra"],"draft":false},"unlisted":false,"prevItem":{"title":"Video Rendering Pipeline for an AI-Driven Text-to-Video Platform","permalink":"/video-rendering-pipeline-for-an-ai-driven-text-to-video-platform"},"nextItem":{"title":"Strot - The API Scraper","permalink":"/strot-is-a-api-scraper"}}')},8453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>n});var r=s(6540);const i={},l=r.createContext(i);function a(e){const t=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function n(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(l.Provider,{value:t},e.children)}}}]);